<%- include('partials/header') -%>
<div class="container">
  <h1>GYM PAGE</h1>
  <div class="">
    <div class="">
      <h2><%= gym.gymName %></h2>
      <img class="" src="<%= gym.image%>" />
      <div class="">

        <!-- LIKE BUTTON -->
        <form
          class=""
          action="/gym/likegym/<%= gym.id %>?_method=PUT"
          method="POST"
        >
          <button class="btn btn-primary fa fa-heart" type="submit"></button>
        </form>
        
        <h3 class="">Likes: <%= gym.likes %></h3>
        <%if(gym.userId == user.id){ %>

         <!-- DELETE GYM BUTTON -->
         <form
         class=""
         action="/gym/deletegym/<%= gym.id %>?_method=DELETE"
         method="POST"
       >
         <button class="btn btn-primary fa fa-trash" type="submit"></button>
       </form>
        <%}%>
      </div>
    </div>
    <div class="">
      <h2><strong>Description:</strong></h2><p><%= gym.caption %></p>
    </div>
    <div class="">
      <h2><strong>Specialty:</strong></h2><p><%= gym.specialty %></p>
    </div>
    <div class="">
      <h2><strong>Business Hours:</strong></h2><p><%= gym.hours %></p>
    </div>
    <div class="">
      <h2><strong>Location:</strong></h2><p><%= gym.location %></p>
    </div>
    <!-- REVIEWS SECTION (ADD REVIEW FORM) -->
    <div class="">
      <h2>Add a review</h2>
      <form action="/review/createReview/<%=gym._id%>" method="POST">
        <div class="">
            <label for="review" class="form-label">Review</label>
            <input type="text" class="form-control" id="review" name="review">
        </div>
        <button type="submit" class="">Submit</button>
      </form>
    </div>
    <!-- DISPLAY LISTED REVIEWS -->
    <ul>
      <% for(var i=0; i<reviews.length; i++) {%>
        <li class="col-6 justify-content-between mt-5">
          <%= reviews[i].reviewBy%> says: <%= reviews[i].review%>

    
<!-- REVIEW EDIT & DELETE BUTTON -->
<div class="row justify-content-between">
    <%if(gym.userId == user.id){ %>  <!--TODO: set to reviewBy = userid-->

      <!-- EDIT REVIEW BUTTON -->
      <!-- TODO: not working for now, figure out href link (ejs syntax)  -->
      
                  <a href="/review/getUpdateReviewPage/<%= reviews[i]._id%>" class="review">
                    <span class="fas fa-edit"></span>
                    </a>
                  <!-- <form
      action="/review/updateReview/<%= reviews[i].review %>?_method=PUT"
      method="POST"
      class="col-3"
    >
      <button class="btn btn-primary fa-solid fa-pencil" type="submit"></button>
    </form> -->
    
    
    
    <!-- DELETE REVIEW BUTTON -->
    <!-- TODO: Action works now, just needs to refresh corectly after delete -->
      <form
      action="/review/deleteReview/<%= reviews[i]._id%>?_method=DELETE"
      method="POST"
      class=""
    >
      <button class="btn btn-primary fa fa-trash" type="submit"></button>
    </form>
    <%}%>
  </div>

        </li>
      <% } %>
    </ul>



    <div class="">

      <a class="btn btn-primary" href="/feed">Return to Feed</a>
        
      
    </div>
  </div>
</div>
<% console.log("Feed Data (reviews): ", reviews) %>
<%- include('partials/footer') -%>


<!-- TODO: UpdateGym & updateReview: separate ejs page? -->